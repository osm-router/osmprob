test_that ("makeCompactGraph", {
               from_id <- c (1, 3, 2, 3, 10, 4, 5, 2, 7, 8, 9, 8, 5, 1, 13, 14, 12, 15, 16, 17)
               to_id <- c (2, 1, 3, 4, 4, 5, 11, 11, 6, 7, 7, 9, 12, 13, 14, 2, 15, 16, 17, 11)
               val <- rep (1, length (to_id))
               oneWay <- c (T, T, F, T, T, T, F, F, T, T, T, F, T, T, T, T, F, F, F, F)
               graph <- data.frame (from_id, to_id, val, val, val, val, val, oneWay)
               graph_out <- makeCompactGraph (graph)

               to <- c (2, 1, 3, 2, 4, 4, 5, 11, 5, 11, 2, 12, 2, 11, 17, 14, 17, 12)
               from <- c (1, 3, 2, 3, 3, 10, 4, 5, 11, 2, 11, 5, 14, 17, 11, 1, 12, 17)
               weight <- c (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 3)
               val <- rep (1, length (weight))
               graph_test <- data.frame (from, to, weight, val, val, val, val)
               expect_equivalent (graph_out, graph_test)
})
